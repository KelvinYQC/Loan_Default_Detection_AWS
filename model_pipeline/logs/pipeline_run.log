2023-05-23 15:49:48 - src.acquire_data - INFO - Acquiring data from: data/subsample_train.csv
2023-05-23 15:49:49 - src.acquire_data - INFO - Saving acquired data to: runs/default/clouds.data
2023-05-23 15:49:53 - src.acquire_data - INFO - Data acquired successfully.
2023-05-23 15:50:36 - src.acquire_data - INFO - Acquiring data from: data/subsample_train.csv
2023-05-23 15:50:37 - src.acquire_data - INFO - Saving acquired data to: runs/default/clouds.data
2023-05-23 15:50:40 - src.acquire_data - INFO - Data acquired successfully.
2023-05-23 15:50:51 - src.train_model - DEBUG - Best parameters: {'classification__penalty': 'l2'}
2023-05-23 15:50:51 - src.train_model - DEBUG - Best score: 0.589696
2023-05-23 15:50:52 - src.train_model - DEBUG - Training and test data saved to runs/default
2023-05-23 15:50:52 - src.train_model - DEBUG - Model saved to runs/default/trained_model_object.pkl
2023-05-23 15:50:52 - src.score_model - DEBUG - Label TARGET dropped from test set.
2023-05-23 15:50:52 - src.score_model - DEBUG - Predicted probabilities added to DataFrame.
2023-05-23 15:50:52 - src.score_model - DEBUG - Binary predictions added to DataFrame.
2023-05-23 15:50:52 - src.score_model - INFO - Scores saved to runs/default/scores.csv
2023-05-23 15:50:52 - src.evaluate_performance - DEBUG - AUC on test: 0.592
2023-05-23 15:50:52 - src.evaluate_performance - DEBUG - confusion_matrix on test generated
2023-05-23 15:50:52 - src.evaluate_performance - DEBUG - Accuracy on test: 0.587
2023-05-23 15:50:52 - src.evaluate_performance - DEBUG - Classification report on test generated
2023-05-23 15:50:52 - src.evaluate_performance - DEBUG - Precision score on test: 0.088
2023-05-23 15:50:52 - src.evaluate_performance - INFO - Evaluation completed
2023-05-23 15:50:52 - src.evaluate_performance - INFO - Results: {'roc_auc_score': '0.5921731920109596', 'confusion_matrix': '[[14563, 10093], [826, 974]]', 'accuracy_score': '0.5872769882068339', 'classification_report': "{'0': {'precision': 0.9463252972902723, 'recall': 0.5906473069435432, 'f1-score': 0.7273317517792482, 'support': 24656}, '1': {'precision': 0.08800939730731001, 'recall': 0.5411111111111111, 'f1-score': 0.15139504157923367, 'support': 1800}, 'accuracy': 0.5872769882068339, 'macro avg': {'precision': 0.5171673472987911, 'recall': 0.5658792090273271, 'f1-score': 0.43936339667924096, 'support': 26456}, 'weighted avg': {'precision': 0.8879276324894961, 'recall': 0.5872769882068339, 'f1-score': 0.6881464600359753, 'support': 26456}}", 'precision_score': '0.08800939730731001'}
2023-05-23 15:50:52 - src.evaluate_performance - INFO - Results saved to runs/default/metrics.yaml
2023-05-23 16:07:45 - src.train_model - DEBUG - Best parameters: {'classification__penalty': 'l2'}
2023-05-23 16:07:45 - src.train_model - DEBUG - Best score: 0.589696
2023-05-23 16:07:47 - src.train_model - DEBUG - Training and test data saved to runs/default
2023-05-23 16:07:47 - src.train_model - DEBUG - Model saved to runs/default/trained_model_object.pkl
2023-05-23 16:07:47 - src.score_model - DEBUG - Label TARGET dropped from test set.
2023-05-23 16:07:47 - src.score_model - DEBUG - Predicted probabilities added to DataFrame.
2023-05-23 16:07:47 - src.score_model - DEBUG - Binary predictions added to DataFrame.
2023-05-23 16:07:47 - src.score_model - INFO - Scores saved to runs/default/scores.csv
2023-05-23 16:07:47 - src.evaluate_performance - DEBUG - AUC on test: 0.592
2023-05-23 16:07:47 - src.evaluate_performance - DEBUG - confusion_matrix on test generated
2023-05-23 16:07:47 - src.evaluate_performance - DEBUG - Accuracy on test: 0.587
2023-05-23 16:07:47 - src.evaluate_performance - DEBUG - Classification report on test generated
2023-05-23 16:07:47 - src.evaluate_performance - DEBUG - Precision score on test: 0.088
2023-05-23 16:07:47 - src.evaluate_performance - INFO - Evaluation completed
2023-05-23 16:07:47 - src.evaluate_performance - INFO - Results: {'roc_auc_score': '0.5921731920109596', 'confusion_matrix': '[[14563, 10093], [826, 974]]', 'accuracy_score': '0.5872769882068339', 'classification_report': "{'0': {'precision': 0.9463252972902723, 'recall': 0.5906473069435432, 'f1-score': 0.7273317517792482, 'support': 24656}, '1': {'precision': 0.08800939730731001, 'recall': 0.5411111111111111, 'f1-score': 0.15139504157923367, 'support': 1800}, 'accuracy': 0.5872769882068339, 'macro avg': {'precision': 0.5171673472987911, 'recall': 0.5658792090273271, 'f1-score': 0.43936339667924096, 'support': 26456}, 'weighted avg': {'precision': 0.8879276324894961, 'recall': 0.5872769882068339, 'f1-score': 0.6881464600359753, 'support': 26456}}", 'precision_score': '0.08800939730731001'}
2023-05-23 16:07:47 - src.evaluate_performance - INFO - Results saved to runs/default/metrics.yaml
2023-05-23 16:08:32 - src.train_model - DEBUG - Best parameters: {'classification__penalty': 'l2'}
2023-05-23 16:08:32 - src.train_model - DEBUG - Best score: 0.589696
2023-05-23 16:08:34 - src.train_model - DEBUG - Training and test data saved to runs/default
2023-05-23 16:08:34 - src.train_model - DEBUG - Model saved to runs/default/trained_model_object.pkl
2023-05-23 16:08:34 - src.score_model - DEBUG - Label TARGET dropped from test set.
2023-05-23 16:08:34 - src.score_model - DEBUG - Predicted probabilities added to DataFrame.
2023-05-23 16:08:34 - src.score_model - DEBUG - Binary predictions added to DataFrame.
2023-05-23 16:08:34 - src.score_model - INFO - Scores saved to runs/default/scores.csv
2023-05-23 16:08:34 - src.evaluate_performance - DEBUG - AUC on test: 0.592
2023-05-23 16:08:34 - src.evaluate_performance - DEBUG - confusion_matrix on test generated
2023-05-23 16:08:34 - src.evaluate_performance - DEBUG - Accuracy on test: 0.587
2023-05-23 16:08:34 - src.evaluate_performance - DEBUG - Classification report on test generated
2023-05-23 16:08:34 - src.evaluate_performance - DEBUG - Precision score on test: 0.088
2023-05-23 16:08:34 - src.evaluate_performance - INFO - Evaluation completed
2023-05-23 16:08:34 - src.evaluate_performance - INFO - Results: {'roc_auc_score': '0.5921731920109596', 'confusion_matrix': '[[14563, 10093], [826, 974]]', 'accuracy_score': '0.5872769882068339', 'classification_report': "{'0': {'precision': 0.9463252972902723, 'recall': 0.5906473069435432, 'f1-score': 0.7273317517792482, 'support': 24656}, '1': {'precision': 0.08800939730731001, 'recall': 0.5411111111111111, 'f1-score': 0.15139504157923367, 'support': 1800}, 'accuracy': 0.5872769882068339, 'macro avg': {'precision': 0.5171673472987911, 'recall': 0.5658792090273271, 'f1-score': 0.43936339667924096, 'support': 26456}, 'weighted avg': {'precision': 0.8879276324894961, 'recall': 0.5872769882068339, 'f1-score': 0.6881464600359753, 'support': 26456}}", 'precision_score': '0.08800939730731001'}
2023-05-23 16:08:34 - src.evaluate_performance - INFO - Results saved to runs/default/metrics.yaml
2023-05-23 16:09:15 - src.train_model - DEBUG - Best parameters: {'classification__penalty': 'l2'}
2023-05-23 16:09:15 - src.train_model - DEBUG - Best score: 0.589696
2023-05-23 16:09:16 - src.train_model - DEBUG - Training and test data saved to runs/default
2023-05-23 16:09:16 - src.train_model - DEBUG - Model saved to runs/default/trained_model_object.pkl
2023-05-23 16:09:16 - src.score_model - DEBUG - Label TARGET dropped from test set.
2023-05-23 16:09:16 - src.score_model - DEBUG - Predicted probabilities added to DataFrame.
2023-05-23 16:09:16 - src.score_model - DEBUG - Binary predictions added to DataFrame.
2023-05-23 16:09:16 - src.score_model - INFO - Scores saved to runs/default/scores.csv
2023-05-23 16:09:16 - src.evaluate_performance - DEBUG - AUC on test: 0.592
2023-05-23 16:09:16 - src.evaluate_performance - DEBUG - confusion_matrix on test generated
2023-05-23 16:09:16 - src.evaluate_performance - DEBUG - Accuracy on test: 0.587
2023-05-23 16:09:16 - src.evaluate_performance - DEBUG - Classification report on test generated
2023-05-23 16:09:16 - src.evaluate_performance - DEBUG - Precision score on test: 0.088
2023-05-23 16:09:16 - src.evaluate_performance - INFO - Evaluation completed
2023-05-23 16:09:16 - src.evaluate_performance - INFO - Results: {'roc_auc_score': '0.5921731920109596', 'confusion_matrix': '[[14563, 10093], [826, 974]]', 'accuracy_score': '0.5872769882068339', 'classification_report': "{'0': {'precision': 0.9463252972902723, 'recall': 0.5906473069435432, 'f1-score': 0.7273317517792482, 'support': 24656}, '1': {'precision': 0.08800939730731001, 'recall': 0.5411111111111111, 'f1-score': 0.15139504157923367, 'support': 1800}, 'accuracy': 0.5872769882068339, 'macro avg': {'precision': 0.5171673472987911, 'recall': 0.5658792090273271, 'f1-score': 0.43936339667924096, 'support': 26456}, 'weighted avg': {'precision': 0.8879276324894961, 'recall': 0.5872769882068339, 'f1-score': 0.6881464600359753, 'support': 26456}}", 'precision_score': '0.08800939730731001'}
2023-05-23 16:09:16 - src.evaluate_performance - INFO - Results saved to runs/default/metrics.yaml
2023-05-23 16:17:04 - src.train_model - ERROR - Error occurred while performing logistic regression: 
All the 10 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/imblearn/pipeline.py", line 297, in fit
    self._final_estimator.fit(Xt, yt, **fit_params_last_step)
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 1160, in fit
    self._validate_params()
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/base.py", line 600, in _validate_params
    validate_parameter_constraints(
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 97, in validate_parameter_constraints
    raise InvalidParameterError(
sklearn.utils._param_validation.InvalidParameterError: The 'penalty' parameter of LogisticRegression must be a str among {'elasticnet', 'l2', 'l1', 'none' (deprecated)} or None. Got {'l2': 0.01} instead.

--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/imblearn/pipeline.py", line 297, in fit
    self._final_estimator.fit(Xt, yt, **fit_params_last_step)
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 1162, in fit
    solver = _check_solver(self.solver, self.penalty, self.dual)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 54, in _check_solver
    raise ValueError(
ValueError: Solver lbfgs supports only 'l2' or 'none' penalties, got l1 penalty.

2023-05-23 16:17:58 - src.train_model - ERROR - Error occurred while performing logistic regression: 
All the 5 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
5 fits failed with the following error:
Traceback (most recent call last):
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/imblearn/pipeline.py", line 297, in fit
    self._final_estimator.fit(Xt, yt, **fit_params_last_step)
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 1162, in fit
    solver = _check_solver(self.solver, self.penalty, self.dual)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kelvin/Desktop/Spring/MSIA_423_cloud/Loan_Default_Detection_AWS/.venv/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 54, in _check_solver
    raise ValueError(
ValueError: Solver lbfgs supports only 'l2' or 'none' penalties, got l1 penalty.

2023-05-23 16:18:38 - src.train_model - ERROR - Error occurred while performing logistic regression: Parameter grid is not a dict ('c')
2023-05-23 16:19:17 - src.train_model - ERROR - Error occurred while performing logistic regression: Parameter grid is not a dict ('N')
2023-05-23 16:20:01 - src.train_model - DEBUG - Best parameters: {'classification__penalty': 'l2'}
2023-05-23 16:20:01 - src.train_model - DEBUG - Best score: 0.589696
2023-05-23 16:20:02 - src.train_model - DEBUG - Training and test data saved to runs/default
2023-05-23 16:20:02 - src.score_model - DEBUG - Label TARGET dropped from test set.
2023-05-23 16:20:02 - src.score_model - DEBUG - Predicted probabilities added to DataFrame.
2023-05-23 16:20:02 - src.score_model - DEBUG - Binary predictions added to DataFrame.
2023-05-23 16:20:02 - src.evaluate_performance - DEBUG - AUC on test: 0.592
2023-05-23 16:20:02 - src.evaluate_performance - DEBUG - confusion_matrix on test generated
2023-05-23 16:20:02 - src.evaluate_performance - DEBUG - Accuracy on test: 0.587
2023-05-23 16:20:02 - src.evaluate_performance - DEBUG - Classification report on test generated
2023-05-23 16:20:02 - src.evaluate_performance - DEBUG - Precision score on test: 0.088
2023-05-23 16:20:02 - src.evaluate_performance - INFO - Evaluation completed
2023-05-23 16:20:02 - src.evaluate_performance - INFO - Results: {'roc_auc_score': '0.5921731920109596', 'confusion_matrix': '[[14563, 10093], [826, 974]]', 'accuracy_score': '0.5872769882068339', 'classification_report': "{'0': {'precision': 0.9463252972902723, 'recall': 0.5906473069435432, 'f1-score': 0.7273317517792482, 'support': 24656}, '1': {'precision': 0.08800939730731001, 'recall': 0.5411111111111111, 'f1-score': 0.15139504157923367, 'support': 1800}, 'accuracy': 0.5872769882068339, 'macro avg': {'precision': 0.5171673472987911, 'recall': 0.5658792090273271, 'f1-score': 0.43936339667924096, 'support': 26456}, 'weighted avg': {'precision': 0.8879276324894961, 'recall': 0.5872769882068339, 'f1-score': 0.6881464600359753, 'support': 26456}}", 'precision_score': '0.08800939730731001'}
2023-05-23 16:21:51 - src.train_model - DEBUG - Best parameters: {'classification__penalty': 'l2'}
2023-05-23 16:21:51 - src.train_model - DEBUG - Best score: 0.589696
2023-05-23 16:21:52 - src.train_model - DEBUG - Training and test data saved to runs/default
2023-05-23 16:21:52 - src.score_model - DEBUG - Label TARGET dropped from test set.
2023-05-23 16:21:52 - src.score_model - DEBUG - Predicted probabilities added to DataFrame.
2023-05-23 16:21:52 - src.score_model - DEBUG - Binary predictions added to DataFrame.
2023-05-23 16:21:52 - src.evaluate_performance - DEBUG - AUC on test: 0.592
2023-05-23 16:21:52 - src.evaluate_performance - DEBUG - confusion_matrix on test generated
2023-05-23 16:21:52 - src.evaluate_performance - DEBUG - Accuracy on test: 0.587
2023-05-23 16:21:52 - src.evaluate_performance - DEBUG - Classification report on test generated
2023-05-23 16:21:52 - src.evaluate_performance - DEBUG - Precision score on test: 0.088
2023-05-23 16:21:52 - src.evaluate_performance - INFO - Evaluation completed
2023-05-23 16:21:52 - src.evaluate_performance - INFO - Results: {'roc_auc_score': '0.5921731920109596', 'confusion_matrix': '[[14563, 10093], [826, 974]]', 'accuracy_score': '0.5872769882068339', 'classification_report': "{'0': {'precision': 0.9463252972902723, 'recall': 0.5906473069435432, 'f1-score': 0.7273317517792482, 'support': 24656}, '1': {'precision': 0.08800939730731001, 'recall': 0.5411111111111111, 'f1-score': 0.15139504157923367, 'support': 1800}, 'accuracy': 0.5872769882068339, 'macro avg': {'precision': 0.5171673472987911, 'recall': 0.5658792090273271, 'f1-score': 0.43936339667924096, 'support': 26456}, 'weighted avg': {'precision': 0.8879276324894961, 'recall': 0.5872769882068339, 'f1-score': 0.6881464600359753, 'support': 26456}}", 'precision_score': '0.08800939730731001'}
2023-05-23 16:24:34 - src.train_model - DEBUG - Best parameters: {'classification__penalty': 'l2'}
2023-05-23 16:24:34 - src.train_model - DEBUG - Best score: 0.589696
2023-05-23 16:24:36 - src.train_model - DEBUG - Training and test data saved to runs/default
2023-05-23 16:24:36 - src.score_model - DEBUG - Label TARGET dropped from test set.
2023-05-23 16:24:36 - src.score_model - DEBUG - Predicted probabilities added to DataFrame.
2023-05-23 16:24:36 - src.score_model - DEBUG - Binary predictions added to DataFrame.
2023-05-23 16:24:36 - src.evaluate_performance - DEBUG - AUC on test: 0.592
2023-05-23 16:24:36 - src.evaluate_performance - DEBUG - confusion_matrix on test generated
2023-05-23 16:24:36 - src.evaluate_performance - DEBUG - Accuracy on test: 0.587
2023-05-23 16:24:36 - src.evaluate_performance - DEBUG - Classification report on test generated
2023-05-23 16:24:36 - src.evaluate_performance - DEBUG - Precision score on test: 0.088
2023-05-23 16:24:36 - src.evaluate_performance - INFO - Evaluation completed
2023-05-23 16:24:36 - src.evaluate_performance - INFO - Results: {'roc_auc_score': '0.5921731920109596', 'confusion_matrix': '[[14563, 10093], [826, 974]]', 'accuracy_score': '0.5872769882068339', 'classification_report': "{'0': {'precision': 0.9463252972902723, 'recall': 0.5906473069435432, 'f1-score': 0.7273317517792482, 'support': 24656}, '1': {'precision': 0.08800939730731001, 'recall': 0.5411111111111111, 'f1-score': 0.15139504157923367, 'support': 1800}, 'accuracy': 0.5872769882068339, 'macro avg': {'precision': 0.5171673472987911, 'recall': 0.5658792090273271, 'f1-score': 0.43936339667924096, 'support': 26456}, 'weighted avg': {'precision': 0.8879276324894961, 'recall': 0.5872769882068339, 'f1-score': 0.6881464600359753, 'support': 26456}}", 'precision_score': '0.08800939730731001'}
